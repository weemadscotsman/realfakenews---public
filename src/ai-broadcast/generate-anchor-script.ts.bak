import { openai } from "../lib/openai-enhanced";

export interface AnchorPersonality {
    displayName: string;
    voice: {
        locale: string;
        gender: string;
        tone: string;
    };
    visual: {
        appearance: string;
        studioStyle: string;
    };
    scriptTone: string;
    catchphrase: string;
}

export async function generateAnchorScript(_anchorName: string, anchor: AnchorPersonality) {
    const prompt = `
Create a satirical news broadcast script for an AI anchor.

Anchor Name: ${anchor.displayName}
Anchor Personality/Tone: ${anchor.scriptTone}
Anchor Catchphrase: ${anchor.catchphrase}

Include:
1. Opening segment with a direct address to the audience in character tone.
2. 3 parody headlines (absurd, satirical, dark humor).
3. A "Darren & Sheila (the Roomba)" update.
4. An "Appliance Grievance" segment where a household item is fed up.
5. A "Conspiracy Desk" revelation.
6. An absurd sponsor advertisement.
7. Closing segment ending with the catchphrase: "${anchor.catchphrase}"

Keep the tone consistent with the anchor's personality.
`;

    const response = await openai.chat.completions.create({
        model: "gpt-4o-mini",
        messages: [{ role: "user", content: prompt }],
        temperature: 0.9,
        max_tokens: 1000,
    });

    return response.choices[0].message.content;
}
